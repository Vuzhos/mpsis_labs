//////////////////////
//     NEW IDEA     //
//////////////////////

# используемые регистры:
# x1 - адрес клавиатруы
# x2 - адрес vga-контроллера
# x3 - предел адреса vga-контроллера (дальше необходимо обнуление адреса vga)
# x5 - маска прерывания
# x7 - считываемой сканкод с клавиатуры
# x8 - данные с таблицы подстановки (?)
# x9 - дублирует x7 за исключением сканкода отпускания клавиши
# x10 - предполагаемый сканкод отпускания клавиши (константа)
# x11 - разрешение на запись в vga (флаг)

# инициализация регистров, выставление адресов
030000b7 # сохраняю базовый адрес клавиатуры в x1
07000137 # сохраняю базовый адрес vga в x2
070011b7 # сохраняю максимальный адрес vga в x3
0f000513 # сохраняю в x10 предполагаемый сканкод отпускания клавиши
00000593 # сохраняю в x11 значение 0
96018193 # что-то для маски прерывания
00100293 # что-то для маски прерывания
30429073 # указываем адрес обработчика перехвата
04800293 # указываем адрес обработчика перехвата
30529073 # устанавливаем вектор прерываний

# основная программа
00058e63 # если x11 == 0, то прыгаю на 7 инструкций (запись запрещена)
00000593 # сохраняю в x11 значение x0 (запрещаю запись)
00048403 # берем данные из таблицы ascii (загружаю в x8 данные по адресу лежащем в x9)
00810023 # загружаю данные из регистра x8 в память по адресу x2 (vga)
00110113 # инкрементирую адрес vga 
0021d463 # если адрес vga не вышел за пределы, то прыгаю на 2 инструкции
07000137 # обнуление адреса 
fe0002e3 # если x0 == 0, то идем на 7 инструкций назад (на проверку x11 == 0)

# обработчик перехвата
0000a383 # грузим сканкод (загружаю в x7 данные по адресу лежащем в x1)
00750663 # если полученный скандкод - отпуск клавиши, то прыгаю на 3 инструкции (на разрешение записи)
00038493 # сохраняю в x9 значение x7
00000463 # прыгаю на две инструкции (на mret)
00100593 # сохраняю в x11 значение 1 (даю разрешение на запись)
30200073 # mret (возвращаюсь на перехваченную инструкцию)

//////////////////////
//     OLD IDEA     //
//////////////////////

00000493 # сохраняю в x9 значение 0 (x9 служит для проверки вывода одинаковых символов)
00000393 # сохраняю в x7 значение 0 (тут будет лежать скан-код)
030000b7 # сохраняем базовый адрес клавиатуры 
07000137 # сохраняем базовый адрес vga-контроллера
070011b7 # количество символов на экране
96018193 # что-то для маски прерывания
00100293 # что-то для маски прерывания
30429073 # указываем адрес обработчика перехвата
04800293 # указываем адрес обработчика перехвата
30529073 # устанавливаем вектор прерываний

00938e63 # если x7 == x9, то прыгаю на 7 инструкций
00038493 # сохраняю в x9 значение x7
00038403 # берем данные из таблицы ascii (загружаю в x8 данные по адресу лежащем в x7)
00810023 # загружаю данные из регистра x8 в память по адресу x2 (vga)
00110113 # инкрементирую адрес vga 
0021d463 # если адрес vga не вышел за пределы, то прыгаю на 2 инструкции
07000137 # обнуление адреса 
fe0002e3 # если x0 == 0, то идем на 7 инструкции назад (на проверку x7 == x9)

# обработчик перехвата
0000a383 # грузим сканкод (загружаю в x7 данные по адресу лежащем в x1)
30200073 # mret (возвращаюсь на перехваченную инструкцию)
